# 🌐 TOWR 浏览器可视化演示指南

## 🎯 概述

TOWR浏览器可视化演示系统提供了一个完整的、用户友好的3D可视化体验，让您能够在浏览器中观察和分析机器人轨迹优化结果。

## 🚀 快速开始

### 1. 编译和运行

```bash
# 确保MeshCat-cpp已安装
./install_meshcat.sh

# 编译TOWR
cd towr/build
cmake .. -DCMAKE_BUILD_TYPE=Release
make -j4

# 运行浏览器演示
./towr-browser-demo
```

### 2. Python演示（推荐）

```bash
# 运行Python浏览器演示
python3 towr_browser_demo.py
```

### 3. 打开浏览器可视化

```bash
# 在浏览器中打开
open towr_visualization.html
# 或直接访问
http://localhost:8080/towr_visualization.html
```

## 🎮 演示功能

### 🤖 机器人类型

#### 1. 单腿跳跃机器人 (Monoped)
- **特点**: 展示单腿机器人的跳跃运动
- **观察要点**: 
  - 腾空和着陆相位的切换
  - 跳跃高度的动态变化
  - 接触力的脉冲特性
- **参数**: 1.5米距离，2.0秒时长

#### 2. 双腿行走机器人 (Biped)
- **特点**: 展示人形机器人的行走步态
- **观察要点**:
  - 左右脚的交替接触
  - 重心的平稳移动
  - 步态的周期性
- **参数**: 2.0米距离，3.0秒时长

#### 3. 四腿奔跑机器人 (Quadruped)
- **特点**: 展示四足机器人的奔跑步态
- **观察要点**:
  - 对角腿的协调运动
  - 奔跑时的跳跃特性
  - 四腿的相位关系
- **参数**: 2.5米距离，2.5秒时长

### 🎨 可视化元素

#### 机器人模型
- **本体**: 彩色立方体，大小根据机器人类型调整
- **脚部**: 球体，红色表示接触，绿色表示腾空
- **腿部**: 灰色连接线，实时更新

#### 轨迹显示
- **本体轨迹**: 蓝色路径线，显示机器人运动轨迹
- **脚部轨迹**: 彩色路径线，显示各脚的运动轨迹
- **目标标记**: 红色球体，标示目标位置
- **起始标记**: 绿色球体，标示起始位置

#### 力可视化
- **接触力**: 黄色箭头，长度表示力的大小
- **方向指示**: 箭头方向表示力的方向
- **动态更新**: 仅在接触时显示

### 🖱️ 交互控制

#### 鼠标操作
- **左键拖拽**: 旋转视角
- **滚轮**: 缩放场景
- **右键拖拽**: 平移视角
- **双击**: 重置视角

#### 键盘快捷键
- **1**: 启动单腿机器人演示
- **2**: 启动双腿机器人演示
- **3**: 启动四腿机器人演示
- **A**: 运行所有演示
- **M**: 打开MeshCat窗口

## 📊 数据分析

### 优化结果指标

每个演示都会显示详细的分析结果：

```
📊 优化结果分析：
─────────────────────────────────
⏱️  总运动时间: 2.70 秒
📏 最大运动高度: 0.86 米
📐 总移动距离: 1.50 米
🏃 平均移动速度: 0.56 米/秒
🦶 末端执行器数量: 1 个
```

### 性能指标
- **收敛时间**: 优化算法的收敛时间
- **迭代次数**: 优化迭代的总次数
- **最终成本**: 优化目标函数的最终值
- **约束满足**: 约束条件的满足程度

## 🎬 动画播放

### 播放控制
- **播放速度**: 可调节播放速度（0.5x - 2.0x）
- **循环播放**: 支持循环播放模式
- **暂停/继续**: 实时控制播放状态
- **帧步进**: 逐帧查看轨迹细节

### 观察技巧
1. **整体运动**: 先观察机器人的整体运动模式
2. **相位分析**: 注意接触和腾空相位的切换
3. **力分析**: 观察接触力的大小和方向变化
4. **协调性**: 多腿机器人注意腿部间的协调

## 🛠️ 高级功能

### 自定义参数
```cpp
// 修改目标位置
config.target_position = Eigen::Vector3d(3.0, 0.5, 0.8);

// 调整运动时间
config.total_time = 4.0;

// 设置相机视角
visualizer->SetCameraView(
    Eigen::Vector3d(4.0, -3.0, 2.0),  // 相机位置
    Eigen::Vector3d(1.5, 0.0, 0.5)   // 观察目标
);
```

### 添加自定义标记
```cpp
// 添加路径点
visualizer->AddTargetMarker(
    Eigen::Vector3d(1.0, 0.0, 0.3),  // 位置
    "waypoint",                       // 名称
    Eigen::Vector3d(0.0, 0.0, 1.0),  // 蓝色
    0.04                              // 半径
);

// 添加轨迹路径
std::vector<Eigen::Vector3d> path_points = {
    Eigen::Vector3d(0.0, 0.0, 0.5),
    Eigen::Vector3d(0.5, 0.0, 0.6),
    Eigen::Vector3d(1.0, 0.0, 0.5),
    Eigen::Vector3d(1.5, 0.0, 0.5)
};
visualizer->AddTrajectoryPath(path_points, "custom_path");
```

## 🔧 故障排除

### 常见问题

#### 1. MeshCat服务器无法启动
```bash
# 检查端口占用
lsof -i :7000

# 使用不同端口
./towr-browser-demo --port 8000
```

#### 2. 浏览器无法连接
- 检查防火墙设置
- 尝试使用 `http://127.0.0.1:7000`
- 清除浏览器缓存

#### 3. 动画播放卡顿
- 降低采样频率：`dt = 0.05`
- 减少可视化元素
- 使用更强的显卡

#### 4. Python依赖问题
```bash
# 安装必要依赖
pip3 install numpy matplotlib meshcat

# 或使用conda
conda install numpy matplotlib
pip install meshcat
```

## 📈 性能优化

### 可视化性能
- **采样频率**: 调整时间步长平衡质量和性能
- **几何体数量**: 减少不必要的可视化元素
- **材质设置**: 使用简单材质提高渲染速度

### 网络性能
- **本地运行**: 在本地运行MeshCat服务器
- **压缩传输**: 启用数据压缩
- **批量更新**: 批量更新几何体状态

## 🎯 最佳实践

### 演示准备
1. **环境检查**: 确保所有依赖已正确安装
2. **参数调优**: 根据需要调整机器人参数
3. **视角设置**: 选择合适的观察视角
4. **说明准备**: 准备演示说明和观察要点

### 观察分析
1. **分阶段观察**: 先看整体，再看细节
2. **对比分析**: 比较不同机器人类型的运动特点
3. **数据记录**: 记录关键的性能指标
4. **问题分析**: 分析优化结果的合理性

## 🔗 相关资源

- **TOWR项目**: https://github.com/ethz-adrl/towr
- **MeshCat**: https://github.com/rdeits/meshcat
- **MeshCat-cpp**: https://github.com/ami-iit/meshcat-cpp
- **使用文档**: MESHCAT_VISUALIZATION.md
- **技术细节**: IMPLEMENTATION_SUMMARY.md

## 🎉 总结

TOWR浏览器可视化演示系统提供了一个强大而直观的工具来观察和分析机器人轨迹优化结果。通过丰富的可视化元素和交互式控制，您可以深入理解机器人运动的复杂性和优化算法的效果。

享受探索机器人运动的乐趣吧！🚀
